'use strict';

document.addEventListener('DOMContentLoaded', () => {

    // --- NUEVA ESTRUCTURA DE DATOS CON ICONOS Y TEMAS ---
    const oracionesPorLibro = {
        "libro1": {
            icono: 'üå±',
            tema: 'tema-verde',
            oraciones: [
                { titulo: "1.- Se√±al de la Santa Cruz", texto: "Por la se√±al de la Santa Cruz,\nde nuestros enemigos,\nl√≠branos, Se√±or, Dios nuestro.\nEn el nombre del Padre y del Hijo y del Esp√≠ritu Santo.\nAm√©n." },
                { titulo: "2.- Padre Nuestro", texto: "Padre nuestro, que est√°s en el cielo,\nsantificado sea tu Nombre;\nvenga a nosotros tu reino;\nh√°gase tu voluntad\nen la tierra como en el cielo.\nDanos hoy nuestro pan de cada d√≠a;\nperdona nuestras ofensas,\ncomo tambi√©n nosotros perdonamos\na los que nos ofenden;\nno nos dejes caer en la tentaci√≥n,\ny l√≠branos del mal.\nAm√©n." },
                { titulo: "3.- Angel de la guarda", texto: "Angel de mi guarda, mi dulce compa√±ia \nno me desampares ni de noche ni de dia, \nno me dejes solo, pues sin ti me perderia. \nAm√©n." }
            ]
        },
        "libro2": {
            icono: 'üêë',
            tema: 'tema-amarillo',
            oraciones: [
                { titulo: "1.- Se√±al de la Santa Cruz", texto: "Por la se√±al de la Santa Cruz,\nde nuestros enemigos,\nl√≠branos, Se√±or, Dios nuestro.\nEn el nombre del Padre y del Hijo y del Esp√≠ritu Santo.\nAm√©n." },
                { titulo: "2.- Padre Nuestro", texto: "Padre nuestro, que est√°s en el cielo,\nsantificado sea tu Nombre;\nvenga a nosotros tu reino;\nh√°gase tu voluntad\nen la tierra como en el cielo.\nDanos hoy nuestro pan de cada d√≠a;\nperdona nuestras ofensas,\ncomo tambi√©n nosotros perdonamos\na los que nos ofenden;\nno nos dejes caer en la tentaci√≥n,\ny l√≠branos del mal.\nAm√©n." },
                { titulo: "3.- Angel de la guarda", texto: "Angel de mi guarda, mi dulce compa√±ia \nno me desampares ni de noche ni de dia, \nno me dejes solo, pues sin ti me perderia. \nAm√©n." },
		{ titulo: "4.- Ave Mar√≠a", texto: "Dios te salve, Mar√≠a, llena eres de gracia;\nel Se√±or es contigo.\nBendita T√∫ eres entre todas las mujeres,\ny bendito es el fruto de tu vientre, Jes√∫s.\nSanta Mar√≠a, Madre de Dios,\nruega por nosotros, pecadores,\nahora y en la hora de nuestra muerte.\nAm√©n." }
  
            ]
        },
        "libro3":  { icono: 'üôè', tema: 'tema-rojo', oraciones: [
                { titulo: "1.- Se√±al de la Santa Cruz", texto: "Por la se√±al de la Santa Cruz,\nde nuestros enemigos,\nl√≠branos, Se√±or, Dios nuestro.\nEn el nombre del Padre y del Hijo y del Esp√≠ritu Santo.\nAm√©n." },
                { titulo: "2.- Padre Nuestro", texto: "Padre nuestro, que est√°s en el cielo,\nsantificado sea tu Nombre;\nvenga a nosotros tu reino;\nh√°gase tu voluntad\nen la tierra como en el cielo.\nDanos hoy nuestro pan de cada d√≠a;\nperdona nuestras ofensas,\ncomo tambi√©n nosotros perdonamos\na los que nos ofenden;\nno nos dejes caer en la tentaci√≥n,\ny l√≠branos del mal.\nAm√©n." },
                { titulo: "3.- Angel de la guarda", texto: "Angel de mi guarda, mi dulce compa√±ia \nno me desampares ni de noche ni de dia, \nno me dejes solo, pues sin ti me perderia. \nAm√©n." },
		{ titulo: "4.- Ave Mar√≠a", texto: "Dios te salve, Mar√≠a, llena eres de gracia;\nel Se√±or es contigo.\nBendita T√∫ eres entre todas las mujeres,\ny bendito es el fruto de tu vientre, Jes√∫s.\nSanta Mar√≠a, Madre de Dios,\nruega por nosotros, pecadores,\nahora y en la hora de nuestra muerte.\nAm√©n." },
                { titulo: "5.- Gloria", texto: "Gloria al Padre y al Hijo y al Esp√≠ritu Santo.\nComo era en el principio, ahora y siempre, por los siglos de los siglos.\nAm√©n." }

] },
        "libro4":  { icono: '‚ú®', tema: 'tema-naranja', oraciones: [

 		{ titulo: "1.- Se√±al de la Santa Cruz", texto: "Por la se√±al de la Santa Cruz,\nde nuestros enemigos,\nl√≠branos, Se√±or, Dios nuestro.\nEn el nombre del Padre y del Hijo y del Esp√≠ritu Santo.\nAm√©n." },
                { titulo: "2.- Padre Nuestro", texto: "Padre nuestro, que est√°s en el cielo,\nsantificado sea tu Nombre;\nvenga a nosotros tu reino;\nh√°gase tu voluntad\nen la tierra como en el cielo.\nDanos hoy nuestro pan de cada d√≠a;\nperdona nuestras ofensas,\ncomo tambi√©n nosotros perdonamos\na los que nos ofenden;\nno nos dejes caer en la tentaci√≥n,\ny l√≠branos del mal.\nAm√©n." },
                { titulo: "3.- Angel de la guarda", texto: "Angel de mi guarda, mi dulce compa√±ia \nno me desampares ni de noche ni de dia, \nno me dejes solo, pues sin ti me perderia. \nAm√©n." },
		{ titulo: "4.- Ave Mar√≠a", texto: "Dios te salve, Mar√≠a, llena eres de gracia;\nel Se√±or es contigo.\nBendita T√∫ eres entre todas las mujeres,\ny bendito es el fruto de tu vientre, Jes√∫s.\nSanta Mar√≠a, Madre de Dios,\nruega por nosotros, pecadores,\nahora y en la hora de nuestra muerte.\nAm√©n." },
                { titulo: "5.- Gloria", texto: "Gloria al Padre y al Hijo y al Esp√≠ritu Santo.\nComo era en el principio, ahora y siempre, por los siglos de los siglos.\nAm√©n." },
		{ titulo: "6.- Credo Niceno-Constantinopolitano", texto: "Creo en un solo Dios, Padre Todopoderoso, \nCreador del cielo y de la tierra, de todo lo visible y \nlo invisible. Creo en un solo Se√±or, \nJesucristo, Hijo √∫nico de Dios, nacido del Padre \nantes de todos los siglos: \nDios de Dios, Luz de Luz, Dios verdadero de Dios \nverdadero, engendrado, no creado, de la misma \nnaturaleza del Padre, por quien todo \nfue hecho; que, por nosotros, los hombres, y por \nnuestra salvaci√≥n baj√≥ del cielo, y por obra del \nEsp√≠ritu Santo se encarn√≥ de Mar√≠a, la Virgen, y \nse hizo hombre; y por nuestra causa fue \ncrucificado en tiempos de Poncio Pilato; padeci√≥ \ny fue sepultado, y resucit√≥ al tercer d√≠a, seg√∫n las \nEscrituras, y subi√≥ al \ncielo, y est√° sentado a la derecha del del Padre; y \nde nuevo vendr√° con gloria para juzgar a vivos y \nmuertos, y su reino no tendr√° fin. \nCreo en el Esp√≠ritu Santo, Se√±or y dador de vida, \nque procede del Padre y del Hijo, que con el \nPadre y el Hijo recibe una misma adoraci√≥n y \ngloria, y que habl√≥ por los profetas. \nCreo en la Iglesia, que es una, santa, \ncat√≥lica y apost√≥lica. \nConfieso que hay un solo Bautismo para el \nperd√≥n de los pecados. Espero la resurrecci√≥n de \nlos muertos y la vida del mundo futuro. Am√©n." }
] },
        "libro5":  { icono: 'üìñ', tema: 'tema-morado', oraciones: [] },
        "libro6":  { icono: 'üåæ', tema: 'tema-granate', oraciones: [] },
        "libro8":  { icono: '‚öì', tema: 'tema-indigo', oraciones: [] },
        "libro9":  { icono: 'üî•', tema: 'tema-azul-marino', oraciones: [] },
        "libro10": { icono: 'üïäÔ∏è', tema: 'tema-dorado', oraciones: [] }
    };

    // --- L√ìGICA DE LA P√ÅGINA (MODIFICADA PARA USAR TEMAS) ---

    const menuLibros = document.getElementById('menu-libros');
    const contenedorOraciones = document.getElementById('contenedor-oraciones');
    let botonActivo = null;

    function hacerOracionDeslizable(elementoOracion) {
        let isDragging = false, startX, currentX;
        
        function onDragStart(e) {
            isDragging = true;
            startX = e.pageX || e.touches[0].pageX;
            elementoOracion.classList.add('arrastrando');
            elementoOracion.style.transition = 'none';
        }

        function onDragMove(e) {
            if (!isDragging) return;
            e.preventDefault();
            currentX = (e.pageX || e.touches[0].pageX) - startX;
            elementoOracion.style.transform = `translateX(${currentX}px)`;
        }

        function onDragEnd() {
            if (!isDragging) return;
            isDragging = false;
            elementoOracion.classList.remove('arrastrando');
            elementoOracion.style.transition = 'transform 0.3s ease, opacity 0.3s ease';
            const umbral = elementoOracion.offsetWidth * 0.4;
            if (Math.abs(currentX) > umbral) {
                elementoOracion.classList.add('desapareciendo');
                setTimeout(() => elementoOracion.remove(), 300);
            } else {
                elementoOracion.style.transform = 'translateX(0)';
            }
        }

        elementoOracion.addEventListener('mousedown', onDragStart);
        document.addEventListener('mousemove', onDragMove);
        document.addEventListener('mouseup', onDragEnd);
        elementoOracion.addEventListener('touchstart', onDragStart, { passive: true });
        document.addEventListener('touchmove', onDragMove);
        document.addEventListener('touchend', onDragEnd);
    }

    function mostrarOraciones(idLibro) {
        // Obtenemos la lista de oraciones desde la nueva estructura
        const oraciones = oracionesPorLibro[idLibro]?.oraciones || [];
        contenedorOraciones.innerHTML = '';

        if (oraciones.length > 0) {
            oraciones.forEach(oracion => {
                const divOracion = document.createElement('div');
                divOracion.className = 'oracion';
                const titulo = document.createElement('h3');
                titulo.textContent = oracion.titulo;
                const texto = document.createElement('p');
                texto.textContent = oracion.texto;
                divOracion.appendChild(titulo);
                divOracion.appendChild(texto);
                contenedorOraciones.appendChild(divOracion);
                hacerOracionDeslizable(divOracion);
            });
        } else {
            contenedorOraciones.innerHTML = '<p class="placeholder">No hay oraciones para este libro todav√≠a.</p>';
        }
    }

    // Crear los botones din√°micamente
    const libros = [1, 2, 3, 4, 5, 6, 8, 9, 10];
    libros.forEach(num => {
        const idLibro = `libro${num}`;
        const infoLibro = oracionesPorLibro[idLibro];
        if (!infoLibro) return;

        const boton = document.createElement('button');
        boton.className = 'btn-libro';
        // ¬°A√±adimos el icono al texto del bot√≥n!
        boton.textContent = `${infoLibro.icono} Libro ${num}`;
        boton.dataset.libro = idLibro;

        boton.addEventListener('click', () => {
            if (botonActivo) {
                botonActivo.classList.remove('activo');
            }
            boton.classList.add('activo');
            botonActivo = boton;

            // ¬°Aplicamos la clase del tema al cuerpo de la p√°gina!
            document.body.className = infoLibro.tema || '';

            mostrarOraciones(idLibro);
        });

        menuLibros.appendChild(boton);
    });
});